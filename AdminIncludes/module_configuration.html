<div class="row">
    <!-- Errors -->
    {loop name="checkrights.predict" type="predict.check.rights"}
        <div class="alert alert-danger">
            <p>{$ERRMES} {$ERRFILE} | {intl l="Please change the access rights" d='predict.ai'}.</p>
        </div>
    {/loop}
</div>

{elseloop rel="checkrights.predict"}

{if $smarty.get.errmes}
    <div class="alert alert-danger">
        {$smarty.get.errmes}
    </div>
{/if}

    {assign tab {$smarty.get.tab|default:"export"}}

<div class="modal fade" id="predict-freeshipping-failed" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">

            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h3>{intl d='predict.ai' l="An error occured"}</h3>
            </div>
            <div class="modal-body" id="predict-freeshipping-failed-body">

            </div>
        </div>
    </div>
</div>


<div class="general-block-decorator">
    <div class="row">
        <div class="col-md-12">
        <ul id="tabbed-menu" class="nav nav-tabs">
            <li class="{if $tab == "export"}active{/if}"><a data-toggle="tab" href="#export">{intl d='predict.ai' l="Export EXAPRINT file"}</a> </li>
            <li class="{if $tab == "prices"}active{/if}"><a data-toggle="tab" href="#prices_slices_tab">{intl d='predict.ai' l="Price slices"}</a></li>
        </ul>
        <div class="tab-content">
        <div id="export" class="tab-pane{if $tab == "export"} active in{/if} form-container">
            {form name="predict.export"}
            {if $form_error}<div class="alert alert-danger">{$form_error_message}</div>{/if}
                <form action="{url path='/admin/module/predict/export'}" id="export_sopredict_form" method="post">
                    {form_hidden_fields form=$form}
                    <div class="panel panel-default">
                        {form_field form=$form field="new_status"}
                        <div class="panel-heading clearfix">
                            {intl d='predict.ai' l="Change orders status after export"}
                        </div>
                        <div class="panel-body">
    
                            <table>
    
                                <tr>
                                    <td>
                                        <label for="nochange">{intl d='predict.ai' l="Do not change"}</label>&nbsp;
                                    </td>
                                    <td>
                                        <input type="radio"  id="status_nochange_radio" name="{$name}" value="nochange" checked/>
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <label for="processing">{intl d='predict.ai' l="Processing"}</label>&nbsp;
                                    </td>
                                    <td>
                                        <input type="radio"  id="status_processing_radio" name="{$name}" value="processing"/>
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <label for="sent">{intl d='predict.ai' l="Sent"}*</label>&nbsp;
                                    </td>
                                    <td>
                                        <input type="radio"  id="status_sent_radio" name="{$name}" value="sent"/>
                                    </td>
                                </tr>
                            </table>
                            {/form_field}
                            <span class="p">{intl d='predict.ai' l="*If you choose this option, the exported orders would not be available on this page anymore"}</span>
                        </div>
                    </div>
                    <table class="table table-striped table-condensed">
                        <thead>
                            <tr>
                                <th class="object-title">
                                    {intl d='predict.ai' l="REF"}
                                </th>
                                <th class="object-title">
                                    {intl d='predict.ai' l="Date"}
                                </th>
                                <th class="object-title">
                                    {intl d='predict.ai' l="Total taxed amount"}
                                </th>
                                <th class="object-title">
                                    {intl d="predict.ai" l="Guaranty"}
                                </th>
                                <th class="object-title">
                                    {intl d='predict.ai' l="Export"}
                                </th>
                            </tr>
                        </thead>
    
                        <tbody>
                        {loop name="predict.notsend.loop" type="predict.notsend.loop"}
                        {form_field form=$form field="order_"|cat:$ID}
                            <tr>
                                <td>
                                    <label for="{$label_attr.for}">
                                        {$label}
                                    </label>
                                </td>
                                <td>
                                    {$CREATE_DATE|date_format}
                                </td>
                                <td>
                                    {$TOTAL_TAXED_AMOUNT} {loop name="list.sopredict.getcurrency" type="currency" id=$CURRENCY}{$SYMBOL}{/loop}
                                </td>
                                <td>
                                    <input type="checkbox" name="guaranty_{$ID}" class="form-control" />
                                </td>
                                <td>
                                    <input type="checkbox" name="{$name}" id="{$label_attr.for}" class="form-control" />
                                </td>
                            </tr>
                        {/form_field}
                        {/loop}
                        {elseloop rel="predict.notsend.loop"}
                            <tr>
                                <td colspan="5">
                                    <br />
                                    <div class="alert alert-info">{intl d='predict.ai' l="There is currently no orders to export"}</div>
                                </td>
                            </tr>
                        {/elseloop}
                        </tbody>
                    </table>
    
                    {ifloop rel="predict.notsend.loop"}
                        <button type="submit"  value="stay" class="form-submit-button btn btn-sm btn-default" title="{intl d='predict.ai' l='Export'}">{intl d='predict.ai' l='Export'}</button>
                    {/ifloop}
                </form>
            {/form}
        </div>
    
    <div id="prices_slices_tab" class="tab-pane {if $tab == "prices"}active in{/if} form-container">
        <!-- checkbox free shipping -->
    {assign var="ispredictFreeShipping" value=0}
    {form  name="predict.freeshipping.form"}
        <br />
        <form action="{url path="/admin/module/predict/freeshipping"}" method="post" id="freeshippingform">
            {form_hidden_fields form=$form}
    
            {form_field form=$form field="freeshipping"}
                <label>
                    {$label}
                </label>
    
                <div class="switch-small freeshipping-activation-Predict" data-id="0" data-on="success" data-off="danger" data-on-label="<i class='glyphicon glyphicon-ok-circle'></i>" data-off-label="<i class='glyphicon glyphicon-remove-circle'></i>">
                    <input type="checkbox" name="{$name}" value="true" {if $data}checked{assign var="ispredictFreeShipping" value=1}{/if} />
                </div>
            {/form_field}
        </form>
    {/form}
    <div id="table-prices-predict" {if $ispredictFreeShipping eq 1} style="display:none;" {/if}>
        <!-- Prices editing -->
        {* -- Add price slice confirmation dialog ----------------------------------- *}
    {loop type="area" name="list area" backend_context=true}
        {include
        file = "includes/generic-create-dialog.html"
    
        dialog_id    = "price_slice_create_dialog_{$ID}"
        dialog_title = {intl d='predict.ai' l="Create a price slice"}
        dialog_body  = "<input type=\"hidden\" name=\"operation\" value=\"add\"/>
                            <input type=\"hidden\" name=\"area\" value=\"{$ID}\" />
                            <label for=\"weight_{$ID}\">{intl d='predict.ai' l="Weight up to ... (kg)"}</label></label>
                            <input type=\"number\" id=\"weight_{$ID}\" name=\"weight\" value=\"1\" class=\"form-control\" pattern=\"\\d+\\.?\\d*\" required/>
                            <label for=\"price_{$ID}\">{intl d='predict.ai' l="Price (€)"}</label></label>
                            <input type=\"number\" id=\"price_{$ID}\" name=\"price\" value=\"1\" class=\"form-control\" pattern=\"\\d+\\.?\\d*\" required/>"
    
    form_action="{url path="/admin/module/predict/prices"}"
    
    dialog_ok_label     = {intl d='predict.ai' l="Create"}
    dialog_cancel_label = {intl d='predict.ai' l="Cancel"}
    }
    <div class="table-responsive">
    <table class="table table-striped table-condensed table-left-aligned">
    <caption class="clearfix">
    {intl d='predict.ai' l="Area : "}{$NAME}
    {loop type="auth" name="can_create" role="ADMIN" module="predict" access="CREATE"}
    <a class="btn btn-default btn-primary pull-right" title="{intl d='predict.ai' l='Create a new price slice'}" href="#price_slice_create_dialog_{$ID}" data-toggle="modal">
                                            <span class="glyphicon glyphicon-plus"></span>
                                        </a>
                                        {/loop}
    </caption>
    <thead>
    <tr>
    <th class="col-md-3">{intl d='predict.ai' l="Weight up to ... (kg)"}</th>
    <th class="col-md-5">{intl d='predict.ai' l="Price (€)"}</th>
    <th class="col-md-1">{intl d='predict.ai' l="Actions"}</th>
    </tr>
    </thead>
    <tbody>
    {loop type="predict" name="predict" area=$ID}
    {* -- EDIT price slice confirmation dialog ----------------------------------- *}
        {include
        file = "includes/generic-confirm-dialog.html"
    
        dialog_id    = "price_slice_edit_dialog_{$ID}_{$MAX_WEIGHT|replace:'.':'-'}"
        dialog_title = {intl d='predict.ai' l="Edit a price slice"}
        dialog_message  = "<input type=\"hidden\" name=\"operation\" value=\"add\"/>
                                    <input type=\"hidden\" name=\"area\" value=\"{$ID}\"/>
                                    <input type=\"hidden\" name=\"weight\" value=\"{$MAX_WEIGHT}\"/>
                                    <label for=\"price_edit_{$ID}_{$MAX_WEIGHT}\">{intl d='predict.ai' l='Price (€)'}</label>
                                    <input type=\"number\" id=\"price_edit_{$ID}_{$MAX_WEIGHT}\" class=\"form-control\" name=\"price\" value=\"{$PRICE}\" pattern=\"\\d+\\.?\\d*\" required/>"
    
    form_action="{url path="/admin/module/predict/prices"}"
    dialog_ok_label     = {intl d='predict.ai' l="Edit"}
    dialog_cancel_label = {intl d='predict.ai' l="Cancel"}
    }
    {* -- Delete price slice confirmation dialog ----------------------------------- *}
        {include
        file = "includes/generic-confirm-dialog.html"
    
        dialog_id    = "price_slice_delete_dialog_{$ID}_{$MAX_WEIGHT|replace:'.':'-'}"
                                    dialog_title = {intl d='predict.ai' l="Delete a price slice"}
    dialog_message  = "<input type=\"hidden\" name=\"operation\" value=\"delete\"/>
                                    <input type=\"hidden\" name=\"area\" value=\"{$ID}\"/>
                                    <input type=\"hidden\" name=\"weight\" value=\"{$MAX_WEIGHT}\"/>
                                    {intl d='predict.ai' l="Do you really want to delete this slice ?"}"
    
    form_action="{url path="/admin/module/predict/prices"}"
    dialog_ok_label     = {intl d='predict.ai' l="Delete"}
    dialog_cancel_label = {intl d='predict.ai' l="Cancel"}
    }
    
    <tr>
    <td>{$MAX_WEIGHT}</td>
    <td>{$PRICE}</td>
    <td>
    <div class="btn-group">
    {loop type="auth" name="can_change" role="ADMIN" module="predict" access="UPDATE"}
    <a class="btn btn-default btn-xs" title="{intl d='predict.ai' l='Edit this price slice'}" href="#price_slice_edit_dialog_{$ID}_{$MAX_WEIGHT|replace:'.':'-'}" data-toggle="modal">
                                                    <span class="glyphicon glyphicon-edit"></span>
                                                </a>
                                                <a class="btn btn-default btn-xs" title="{intl d='predict.ai' l='Delete this price slice'}" href="#price_slice_delete_dialog_{$ID}_{$MAX_WEIGHT|replace:'.':'-'}" data-toggle="modal">
                                                    <span class="glyphicon glyphicon-trash"></span>
                                                </a>
                                                {/loop}
    </div>
    </td>
    </tr>
    {/loop}
    </tbody>
    </table>
    </div>
    {/loop}
    </div>
    </div>
    </div>
    </div>
</div>
    
    
    
</div>

{/elseloop}